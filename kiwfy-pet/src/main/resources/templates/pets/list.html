<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org" th:replace="~{layout :: layout('Pets', ~{::content})}">

<body>
    <div th:fragment="content">
        <div class="container mt-4">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h1>Lista de Pets</h1>
                <a th:href="@{/pets/novo}" class="btn btn-kiwi-brown">Novo Pet</a>
            </div>

            <!-- Mensagens de sucesso/erro -->
            <div th:if="${sucesso}" class="alert alert-success alert-dismissible fade show" role="alert">
                <span th:text="${sucesso}"></span>
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
            <div th:if="${erro}" class="alert alert-danger alert-dismissible fade show" role="alert">
                <span th:text="${erro}"></span>
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>

            <!-- Tabela de pets -->
            <div th:if="${pets != null and !pets.isEmpty()}" class="card">
                <div class="card-body">
                    <table class="table table-striped table-hover">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Foto</th>
                                <th>Nome</th>
                                <th>Espécie</th>
                                <th>Raça</th>
                                <th>Tutor</th>
                                <th>Bairro</th>
                                <th>Idade</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="pet : ${pets}">
                                <td th:text="${pet.id}"></td>
                                <td>
                                    <img th:src="${pet.fotoUrl != null && !pet.fotoUrl.isEmpty() ? pet.fotoUrl : 'https://placehold.co/80x60?text=Pet'}"
                                        style="width:80px; height:60px; object-fit: cover; object-position: center;"
                                        alt="foto pet">
                                </td>
                                <td th:text="${pet.nome}"></td>
                                <td th:text="${pet.especie}"></td>
                                <td th:text="${pet.raca}"></td>
                                <td th:text="${pet.tutor != null ? pet.tutor.nome : 'Sem tutor'}">
                                    </td>
                                    <td th:text="${pet.bairro != null ? pet.bairro : 'N/A'}"></td>
                                    <td th:text="${pet.owner != null ? pet.owner.nome : 'Sem tutor'}"></td>
                                    
                                    <a th:href="@{/pets/editar/{id}(id=${pet.id})}"
                                        class="btn btn-sm btn-kiwi-brown">Editar</a>
                                    
                                    <a th:href="@{/pets/editar/{id}(id=${pet.id})}" class="btn btn-sm btn-warning">
                                        <i class="bi bi-pencil"></i> Editar
                                    </a>
                                    
                                    <a th:href="@{/pets/excluir/{id}(id=${pet.id})}" class="btn btn-sm btn-danger"
                                        onclick="return confirm('Tem certeza que deseja excluir este pet?')">
                                        <i class="bi bi-trash"></i> Excluir
                                    </a>
                                    </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Mensagem quando não há pets -->
            <div th:if="${pets == null or pets.isEmpty()}" class="alert alert-success">
                <h5 class="mb-1">Nenhum pet cadastrado ainda.</h5>
                <p class="mb-0">Clique em "Novo Pet" para começar a cadastrar.</p>
            </div>
        </div>
    </div>
</body>

</html>